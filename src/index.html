<meta charset="utf8">
<link rel="stylesheet" type="text/css" href="css/style.css">

<div id="inputs">
	<form>
		<input type="text" name="set" data-default="random_2d(100000)" placeholder="Ensemble" style="width:300px">
		<button>Regénérer</button>
	</form>
	<form>
		<input type="text" name="width" data-default="400" placeholder="Largeur" style="width:100px">
		<input type="text" name="accuracy" data-default="40" placeholder="Précision" style="width:100px">
		<button style="display:none"></button>
	</form>
</div>
<canvas id="graph" width="200" height="200"></canvas>
<p id="outputs">
	<table style="width:100%;text-align:center">
		<tr><th>Pourcentage</th><th>Quantité</th><th>Indice</th></tr>
		<tr><td></td><td></td><td></td></tr>
	</table>
</p>

<script src="js/jquery.min.js"></script>
<script src="js/libs/biginteger.js"></script>
<script src="js/libs/schemeNumber.js"></script>
<script src="js/classes/fraction.js"></script>
<script src="js/classes/graph.js"></script>
<script src="js/classes/set.js"></script>
<script>
	$('#inputs input').each(function(){
		var v = localStorage.getItem($(this).attr('name'))
		$(this).val(v != undefined ? v : $(this).data('default'))
	})

	var graph = new Graph($('#graph')), set

	$('#inputs form:eq(1)').submit(function(e){
		graph.size($(this).find('input:eq(0)').val(), $(this).find('input:eq(1)').val())
		graph.draw(set)

		$('#inputs input').each(function(){
			localStorage.setItem($(this).attr('name'), $(this).val())
		})

		e.preventDefault()
	})
	$('#inputs form:eq(0)').submit(function(e){		
		eval('set = '+$(this).find('input:eq(0)').val())
		$('#inputs form:eq(1)').submit()

		e.preventDefault()
	}).submit()

	$('#graph').mousemove(function(e){
		var x = e.pageX - $(this).offset().left, y = e.pageY - $(this).offset().top
		var intensity = $(this)[0].getContext("2d").getImageData(x, y, 1, 1).data[0]

		var percentage = intensity/255

		$('#outputs tr:eq(1) td:eq(0)').text(parseInt(percentage*100)+'%')
		$('#outputs tr:eq(1) td:eq(1)').text(parseInt(percentage*$(this).data('max'))+' / '+$(this).data('total'))
		$('#outputs tr:eq(1) td:eq(2)').text($(this).data('index'))

		// trouver "ecart type" en anglais
	})
</script>